#+TITLE: PhD Log
#+AUTHOR: Tigany Zarrouk
#+LATEX_HEADER: \usepackage[hyperref,x11names]{xcolor}
#+LATEX_HEADER: \usepackage{physics}
#+LATEX_HEADER: \usepackage{cases}
#+LATEX_HEADER: \graphicspath{ {./} }
#+LATEX_HEADER: \usepackage{tikz}
#+LATEX_HEADER: \usetikzlibrary{arrows,plotmarks,calc,positioning,fit}
#+LATEX_HEADER: \usetikzlibrary{shapes.geometric, decorations.pathmorphing, patterns, backgrounds}
#+LATEX_HEADER: \newcommand{\tikzremember}[1]{{  \tikz[remember picture,overlay]{\node (#1) at (0,11pt) { };}}}
#+LATEX_HEADER: \tikzset{snake it/.style={decorate, decoration=snake}}
#+LATEX_HEADER: \usepackage[nottoc]{tocbibind}




* Tasks


** TODO Ti3Al report---DFT chapter 
- Start with the theory of DFT with the HK theorem and KS equations to solve
  for the density.
- Talk a bit about the approximations that are made. 
- Alloy theory and the structure of Ti3Al
- Look at literature to do with all of this. Go through why solutes are
  incredibly important and why it is necessary do to this research.
- How can solutes lead to failure and why is oxygen in particular bad for the alloy.
- Is it wavy or planar slip
- Go into the calculations and what I have done for them
- Cite the research about the Fe and C vacancy concentration and what the
  implications are for alloy research
- What can I add to the research. 
** TODO Ti/Ti3Al DFT oxygen interstitial/vacancy binding energy 
Want to find the vacancy formation energy, and the dissolution energy of
oxygen interstitials at different sites in the Ti3Al lattice. 

From these measurements we can then do a final calculation on the binding
energy of oxygen to a vacancy thus elucidating if it is favourable comapared
to just the normal positions. 

This will provide insight into the high amount of vacancies with oxygen. 
*** Notes on the calculations
**** Setting up relaxation
- To set up one calculates the self consistent density first by not initiating
relaxation. 

- Using the OPTIONS_HF flag one can minimise the energy with respect to the
Harris-Foulkes energy, which is far faster. And it would use the initial
electron density for the relaxation, and then only calculate the density using
the overlap of atomic densities. 

One is then able to minimise the energy accordingly. 

**** Basis set optimisatons

***** Notes on the basis set
It has been seen that the a smaller sphere radius for the oxygen was giving a much
larger overlap (~17%) in the T2 interstitial site than any of the octahedral
sites, which have an overlap of ~1.6%. 

This would have decreased the accuracy of the results. 

So to decrease the radius of the oxygen and to increase the completeness of
the basis set one can introduce plane waves between certain energies such that
the plane wave basis set is more complete.

This should make the Harris-Foulkes energy smaller by the variational
principle. 

<2019-05-23 Thu 18:19>

It seems that there is an optimal sphere radius of around 0.8. 
The best plane wave energy max seems to be at the maximum of around 3 Rydberg,
but this is at the edge of the range of search so it seems that the range
needs to be extended such that an optimum can be found before the basis set
becomes overcomplete. 

<2019-05-24 Fri 16:05>

There seems to be an optimum. I shall stop putting the plane wave basis set up
in energy and now making pwemax = 4.0 ryd. 

The best sphere radius for the oxygen is 0.78.


<2019-05-24 Fri 18:01>

Asking Dimitar about the plane wave basis set, he said to use the defaulf
values that are generated when making a blm file. 



***** Perfect lattice
spec name old rmax new rmax ratio 
1 Ti 2.707297 3.024213 1.117060 
2 Al 2.638772 2.947667 1.117060

Ti RSMH= 1.805 1.805 1.196 1.805 EH= -0.1 -0.1 -0.1 -0.1 
   RSMH2= 1.805 1.805 1.269 EH2= -0.9 -0.9 -0.9 P= 4.699 4.466 3.875 4.155 5.089 
Al RSMH= 1.759 1.759 1.352 EH= -0.1 -0.1 -0.1 
   RSMH2= 1.759 1.759 EH2= -0.9 -0.9 P= 3.837 3.75 3.392 4.13 5.089

gmax = 6.6

Ti RSMH= 1.805 1.805 1.269 1.805 EH= -0.1 -0.1 -0.1 -0.1 
   RSMH2= 1.805 1.805 1.269 EH2= -0.9 -0.9 -0.9 P= 4.699 4.466 3.875 4.155 5.089 
Al RSMH= 1.759 1.759 1.759 EH= -0.1 -0.1 -0.1 RSMH2= 1.759 1.759 EH2= -0.9 -0.9 P= 3.837 3.75 3.392 4.13 5.089

***** O2 site (least overlap)
spec name old rmax new rmax ratio 
1 Ti 2.663548 2.746597 1.031179 
2 Al 2.576718 2.746597 1.065928 
3 O 1.662251 1.714079 1.031179

Ti RSMH= 1.776 1.776 1.254 1.776 EH= -0.1 -0.1 -0.1 -0.1 RSMH2= 1.776 1.776 1.254 
   EH2= -0.9 -0.9 -0.9 P= 4.686 4.447 3.874 4.155 5.089 PZ= 0 13.9381 
Al RSMH= 1.718 1.718 1.718 EH= -0.1 -0.1 -0.1
   RSMH2= 1.718 1.718 EH2= -0.9 -0.9 P= 3.83 3.74 3.389 4.13 5.089 
O RSMH= 0.845 0.82 1.108 1.108 EH=-0.505 -0.1 -0.1 -0.1 RSMH2= 0.845 0.82 
   EH2= -1.305 -0.9 P= 2.886 2.858 3.25 4.11

***** O1 site (next least overlap)
spec name old rmax new rmax ratio 
1 Ti 2.641151 2.734882 1.035489 
2 Al 2.638731 3.547117 1.344251 
3 O 1.666646 1.725793 1.035489

gmax = 9.8
Ti RSMH= 1.761 1.761 1.246 1.761 EH= -0.1 -0.1 -0.1 -0.1 
   RSMH2= 1.761 1.761 1.246 EH2= -0.9 -0.9 -0.9 P= 4.679 4.437 3.873 4.155 5.089
   PZ= 0 13.9376 
Al RSMH= 1.759 1.759 1.759 EH= -0.1 -0.1 -0.1 
   RSMH2= 1.759 1.759 EH2= -0.9 -0.9 P=3.837 3.75 3.392 4.13 5.089 
O RSMH= 0.846 0.821 1.111 1.111 EH= -0.506 -0.1 -0.1 -0.1 RSMH2= 0.846 0.821
EH2= -1.306 -0.9 P= 2.886 2.859 3.25 4.11

***** T1 site (next most overlap)

spec name old rmax new rmax ratio 
1 Ti 2.654621 2.490980 0.938356 
2 Al 2.586159 2.447921 0.946547 
3 O 1.473639 1.382798 0.938356

gmax = 8.9

Ti RSMH= 1.77 1.77 1.251 1.77 EH= -0.1 -0.1 -0.1 -0.1 
   RSMH2= 1.77 1.77 1.251 EH2= -0.9 -0.9 -0.9 P= 4.683 4.443 3.874 4.155 5.089
   PZ= 0 13.9379 
Al RSMH=1.724 1.724 1.724 EH= -0.1 -0.1 -0.1 RSMH2= 1.724 1.724 EH2= -0.9 -0.9 
   P= 3.831 3.742 3.389 4.13 5.089 
O RSMH= 0.831 0.982 0.982 0.982 EH= -0.474 -0.1 -0.1 -0.1 RSMH2= 0.831 0.982 
  EH2= -1.274 -0.9 P= 2.871 2.845 3.25 4.11

***** T2 site (Most overlap)
# 3 ti atom coordination and al atom on to



*** Vacancy formation energy definition

$$ \Delta E_{\text{f}}^{\text{vacancy}} = \lim_{N_\text{a} \to \infty} 
                                            \big\{E(N_\text{a}, 1) 
                                               - E(N_\text{a} - 1, 0)   \big\}  $$

Where the first argument of the energy function is the number of lattice sites
and the second denotes the number of vacancies. cite:Finnis1997

*** Dissoluton energy of species definition

The solution enthalpy of particular species is given by 

$$ E_{text{solution}} = E( \text{Ti}_{N}X_1 ) - E( \text{Ti}_{N}) - E( X ) $$

This is the same as  a formation energy $\Delta E^{\text{f}}_{\text{O}}$
*** Vacancy-solute binding energy 
cite:wolverton07_solut_vacan_bindin_alumin

$$ -E_{\text{bind}}( X - \text{Vac} ) = E( \text{Ti}_{N - 2} X_1 \text{Vac}_1 )
                                         + E( \text{Ti}_{N}) 
                                         - E( \text{Ti}_{N - 1} X_1 ) 
                                         - E( \text{Ti}_{N - 1} \text{Vac}_1 ) $$

where Vac is a vacancy, X is a solute impurity. The binding energy is negative
here to keep with the convention that a /positive/ binding energy is
/favourable/.

I think that there really is a minus sign here


cite:deng16_ab_initio_solut_inter_impur

$$ E_{\text{bind}}^{V - X} =   + E( \text{Ti}_{N - 1} X_1 ) 
                               + E( \text{Ti}_{N - 1} \text{Vac}_1 ) 
                               - E( \text{Ti}_{N - 2} X_1 \text{Vac}_1 )
                               - E( \text{Ti}_{N})                       $$

*** Dilute impurity energy and Vacancy formation energy  
cite:wolverton07_solut_vacan_bindin_alumin
$$ E_{text{impurity}}(X) = E( \text{Ti}_{N-1}X_1 ) 
                         + \frac{N-1}{N} E(\text{Ti}_{N}) 
                         - E( X ) $$

$$ E_{text{vacancy}}(\text{Vac}) = E( \text{Ti}_{N-1}\text{Vac}_1 ) 
                                     + \frac{N-1}{N} E(\text{Ti}_{N}) $$






*** Relevant papers 
cite:bakulin17_absor_diffus_oxygen_ti3al_alloy 

cite:wei11_effec_o_binar_phase_tial_ti3al_alloy

cite:bakulin18_effec_impur_format_energ_point

cite:mishin00_diffus_ti_al_system

cite:koizumi08_oxygen_diffus_ti3al_singl_cryst




Koizumi states that there is a preference for the interstitial site that is O1
(6 Ti atom coordination). O2 sites (4 Ti & 2 Al atom coordination), is of higher
energy. 

| Site | Neighbouring atoms |
|------+--------------------|
| O1   | 6 Ti               |
| O2   | 4 Ti, 2 Al         |
| T1   | 3 Ti, 1 Al (on Ti) |
| T2   | 3 Ti, 1 Al (on Al) |

on Ti: the tetrahedral site is located just above a Ti atom in the c-axis direction.
on Al: the tetrahedral site is located just above an Al atom in the c-axis direction.



E_vacancy_formation
| Author         | Geometry       |  V_Ti |  V_Al |
|----------------+----------------+-------+-------|
| Baulkin (2018) | 2 x 2 x 2      | 2.209 | 2.894 |
| Mishin  (2000) | Embedded atom? | 1.314 | 1.805 |


E_absorption = - E_solution 
The lower the solution the higher the binding energy 
the higher the absorption energy, the higher the binding energy. 

| Author         | Geometry                            |   O1 |   O2 |   T1 |   T2 |
|----------------+-------------------------------------+------+------+------+------|
| Wei     (2011) | Ti3Al/TiAl interface (6 & 6 layers) | 6.23 | 4.75 | 4.20 | 3.83 |
| Baulkin (2017) | 2 x 2 x 2                           | 6.16 | 4.69 | 4.24 | 3.78 |

During relaxation it was found that the tetrahedral sites are unstable and
that they actually prefer the hexahedral sites (Baulkin). 

The chemical potential/diatomic reference energy for the oxygen molecule
decreases with increasing temperature. 
|----+------+-------+-------+------+-------+-------+-------+-------+--------+--------|
| T  | (K)  |     0 |   500 | 1000 |  2000 |  2500 |  3000 |  4000 |   4500 |   5000 |
| μO | (eV) | −4.35 | −4.89 | −5.5 | −6.83 | −7.54 | −8.27 | −9.78 | −10.55 | −11.34 |


cite:hagen98_point_defec_chemic_poten_order_alloy

Looked at point defects and soluted in an $\text{A}_m\text{B}_n$ lattice. 

It is difficult to determine the concentrations of both vacancies and antisite
(substitutional of the other alloying element) defects reliably due to:
- Slow rates of diffusion -> Long equilibriation times.

Point-defect concentrations intimiately linked to chemical potentials of the
constituents, and these chemical potentials can be used to discuss relative
stability of different grain-boundary structures by comparing excess free
energies. 

We can say that there exists two sublattices, an A sublattice of $m$ sites and a B
sublattice of $n$ sites, with all atoms of a particular type only belonging to that
sublattice. 

The alloy deviates slightly from stochiometry so we have
$\text{A}_{x}\text{B}_{1-x}$ where we suppose $x$ to be within a few percent
of $m/(m+n)$. Each site of each sublattice can by occupied by its own atom or
an atom of the other kind or a vacancy.

$c_{aa}$ = concentration of A atoms on the A sublattice; 
$c_{bb}$ = concentration of B atoms on the B sublattice;        
$c_{ab}$ = concentration of A atoms on the B sublattice;       
$c_{ba}$ = concentration of B atoms on the A sublattice;       
$c_{va}$ = concentration of vacancies on the A sublattice;     
$c_{vb}$ = concentration of vacancies on the B sublattice.

Number of A and B sublattice cites are $Nm$ and $Nn$. $N$ is the number of
fomulae units, which can vary due to the creation/annihilation of vacancies
when the temperature or stochiometry varies, while the ratio $m/n$ is
constant. 

A canonical ensemble is assumed so that the total numbers of A and B atoms are
conserved. 

There are 7 unknowns in a statistical model of the concentrations, $c_i$ and
$N$ and they satisfy the constraints 

\[ c_{aa} + c_{ba} + c_{va} = 1  \] 
\[ c_{bb} + c_{ab} + c_{vb} = 1  \]

There are fixed numbers $n_a$ and $n_b$ of A and B atoms are given by 

\[ N ( m c_{aa}  +  n c_{ab} )  =  n_a \]
\[ N ( m c_{ba}  +  n c_{bb} )  =  n_b \]

There are seven unknowns and four equations so there are three independent
variables. The conservation of atoms constrains the possible defects which can
be generated thermally. The effect of possible defect clustering or ordering
is not included. 


For a material of a single element, the calculation of, for example, the
vacancy formation energy is simple: calculate the total energy of a perfect
lattice and subtract it from the energy of a lattice with a defect. This is
unique if $N$ is sufficiently large and /the same number of atoms is compared/
with and without the defect. 

For an ordered alloy the stochiometry comes into account, so it is not as
simple. The physical consequences, of having a working definition, are that we
take the equilibrium concentrations of the four point defects and that they
must be independent of the definition adoped for the point-defect energies, as
long as the formulation is consistent. 

If all we want at the end of the calcuation are the equilibrium point-defect
concentrations, we do not need single point-defect energies, but rather the
energies of threee independent stociometry-conserving complex defects. For
example it is possible to compare the energy of a block AB containing a pair of
vacancies or a triple defect with the energy of the same numbers of A and B
atoms in a perfect crystal. However the above uniquely defined complex defect
energies can be constructed simple from calculations of individual point-deect
energies. 


$e_{\text{mol}}$: Cohesive energy / energy per unit mole.  
We can arbitrariliy divide this between atoms of A and B type. This is a
natural division in EAM potentials or BOP potentials which allocate energies to
each atom. 

\[ e_{\text{mol}} = m e_{aa} + n e_{bb}  \]

The energy of a block containing $Nm$ sites of sublattice A and $Nn$ sites of
sublattice B is now:


\[ E = Nm ( c_{aa} e_{aa} + c_{ba} e_{ba} + c_{va} e_{va} ) 
     + Nn ( c_{bb} e_{bb} + c_{ab} e_{ab} + c_{vb} e_{vb} ) \]

The assumption has been made that the point defects are assumed to be
sufficiently dilute that interactions may be neglected. 

We can caw calculate the formation energy $e_{vb}$ of a B vacancy. Construct
block of $N$ formula units with $Nm$ sites of A, fully occupies by type A
atoms, and $Nn - 1$ sites of type B with a vacancy on the remaining site.

\[ e_{vb} = E(N, vb) - Nm e_{aa} - ( Nn - 1 ) e_{bb} \]

The energy of an A antisite is:
\[ e_{ab} = E(N, ab) - Nm e_{aa} - ( Nn - 1 ) e_{bb} \]

One can define stochiometry-conserving complexes (in the case of NiAl) 

\[ e_{2v} =   e_{va} + e_{vb} \]
\[ e_{ta} = 2 e_{vb} + e_{ba} - e_{bb} \]
\[ e_{tb} = 2 e_{va} + e_{ab} - e_{aa} \]

This formalism can be generalised to finite temperature if for /energy/ we read
/free energy/ and the include both the vibrational entropy and the effect of
temperature on the formation energies. (We are not including configurational
entropy at this stage). Essentially one can do phonon calculations and then
obtain the entropy from standard formulae. The effect is to add $- Ts_i$ to
each of the $e_i$.


To find the enthalpy of the defected crystal, neglecting elastic strains, the
total volume can be written as 

\[ V = Nm ( c_{aa} \Omega_{aa} + c_{ba} \Omega_{ba} + c_{va} \Omega_{va} ) 
     + Nn ( c_{bb} \Omega_{bb} + c_{ab} \Omega_{ab} + c_{vb} \Omega_{vb} ) \]

where $\Omega_i$ are the partial molar volume and the quantity $m\Omega_{aa} +
n\Omega_{bb}$ is uniquely defined as the volume per formula unit, but like the
energies this is arbitrarily defined between A and B. 


Relaxation volumes are uniquely defined, like that of a B vacancy:
\[ \Omega_{bb} - \Omega_{vb} = N( m \Omega_{aa} + n \Omega_{bb} ) - V(N,vb)  \]

where $V(N,vb)$ is the volume of a crystal with $N$ formula units with a single
vacancy of the B sublattice. 

Adding the $pV$ term to construc the enthalpy amounts to replacing $e_i$ by
$e_i + p\Omega_i$ everywhere. The total Gibbs free energy without the
configurational part is therefore given by replacing each of the $e_i$ in the
equations for $e_{vb}$ and $e_{ab}$ with $e_i + p\Omega_i - T s_i$. These
pressure and entropy terms are not included in the following for simplicity but
they can be included. 

The configurational entropy of the model system is 

\[ S = Nmk ( c_{aa} \text{log} c_{aa} + c_{ba} \text{log} c_{ba} + c_{va} \text{log} c_{va} ) 
     - Nnk ( c_{bb} \text{log} c_{bb} + c_{ab} \text{log} c_{ab} + c_{vb} \text{log} c_{vb} ) \]

** TODO Write up fitting and optimisation 
** TODO Gamma Surfaces for New Model 
** TODO Titanium Optimisation
*** Not great parameter sets but ones to minimise
**** Amazing c/a and alat


PARAMETERS fdd=0.2144244969 qdds=0.6050632996 qddp=0.5243078766 qddd=0.6099475556
b0=106.1517590645 p0=1.5476277744 b1=0.0000000000 p1=0.7770862059 ndt=1.9000000000
cr1= -6.5623249147 cr2=3.5000000000 r1dd=5.6883247800 rcdd=7.6402009300
cr3=-1.0000000000 rmaxhm=7.7166029393 npar=11 

VARGS 

-vfdd=0.2144244969
-vqdds=0.6050632996 -vqddp=0.5243078766 -vqddd=0.6099475556 -vb0=106.1517590645
-vp0=1.5476277744 -vb1=0.0000000000 -vp1=0.7770862059 -vndt=1.9000000000
-vcr1=-6.5623249147 -vcr2=3.5000000000 -vr1dd=5.6883247800 -vrcdd=7.6402009300
-vcr3=-1.0000000000 -vrmaxhm=7.7166029393 

python new_Ti.py -p ' fddtt=0.2144244969 qddstt=0.6050632996 qddptt=0.5243078766 qdddtt=0.6099475556 b0tt=106.1517590645 p0tt=1.5476277744 b1tt=0.0000000000 p1tt=0.7770862059 ndt=1.9000000000 cr1=-6.5623249147 cr2=3.5000000000 r1tt=5.6883247800 rctt=7.6402009300 cr3=-1.0000000000 rmaxh=7.7166029393 '

python new_Ti.py -p 'fddtt=0.2333099092 qddstt=0.553054336 qddptt=0.5444939144
qdddtt=0.659614557 b0tt=112.9541786 p0tt=1.525026006 b1tt=-0.01877495619
p1tt=1.03686837 ndt=2.001695444 cr1=-6.026426049 cr2=4.014251378 r1tt=31.38
rctt=48.63 cr3=-1.0 rmaxh=48.64 ' 
|-----------+--------------+--------------+-------------+-------------+------------+--------------+----------|
| a_hcp:    |   5.57902625 |   5.57678969 |  0.79700375 |  0.79668424 | 0.00000010 | 500.00000000 |     0.51 |
| c/a:      |   1.58461146 |   1.58731122 | 11.91498447 | 11.93528444 | 0.00041209 | 100.00000000 |   412.09 |
| a_omega:  |   8.70213425 |   8.73254342 |  1.08776678 |  1.09156793 | 0.00001445 |  10.00000000 |     1.44 |
| c_omega:  |   5.50951230 |   5.32343103 |  0.68868904 |  0.66542888 | 0.00054103 |  10.00000000 |    54.10 |
| a_4h:     |   5.56223247 |   5.56325146 |  0.99981684 |  1.00000000 | 0.00000003 |   1.00000000 |     0.00 |
| c_4h:     |  17.79794667 |  17.75908031 |  1.00218853 |  1.00000000 | 0.00000479 |   1.00000000 |     0.05 |
| a_6h:     |   5.55859288 |   5.54639384 |  1.00219945 |  1.00000000 | 0.00000484 |   1.00000000 |     0.05 |
| c_6h:     |  26.77978387 |  26.77136353 |  1.00031453 |  1.00000000 | 0.00000010 |   1.00000000 |     0.00 |
| a_bcc:    |   6.05677186 |   6.17948863 |  0.86525312 |  0.88278409 | 0.00030733 |   1.00000000 |     3.07 |
| a_fcc:    |   7.82708009 |   7.88677000 |  1.11815430 |  1.12668143 | 0.00007271 |   1.00000000 |     0.73 |
| DE(o,h):  |   3.63476000 |  -0.64073333 |  0.24231733 | -0.04271556 | 0.08124375 | 100.00000000 | 81243.75 |
| DE(4h,h): |   0.52512000 |   3.17160000 |  0.00210048 |  0.01268640 | 0.00011206 | 100.00000000 |   112.06 |
| DE(6h,h): |   1.71472167 |   3.72005000 |  0.00685889 |  0.01488020 | 0.00006434 | 100.00000000 |    64.34 |
| DE(b,h):  |  34.68445000 |   7.63520000 |  0.35034798 |  0.07712323 | 0.07465176 |   1.00000000 |   746.52 |
| DE(f,h):  |   3.93747000 |   4.51880000 |  0.03977242 |  0.04564444 | 0.00003448 | 100.00000000 |    34.48 |
| c_11:     | 149.23676367 | 176.10000000 |  0.65188819 |  0.76923077 | 0.01376928 |  10.00000000 |  1376.93 |
| c_33:     | 164.51539821 | 190.50000000 |  0.66430607 |  0.76923077 | 0.01100919 |  10.00000000 |  1100.92 |
| c_44:     |  53.08939680 |  50.80000000 |  0.80389759 |  0.76923077 | 0.00120179 |  10.00000000 |   120.18 |
| c_12:     |  40.74302545 |  86.90000000 |  0.36065350 |  0.76923077 | 0.16693539 |  10.00000000 | 16693.54 |
| c_13:     |  43.05797008 |  68.30000000 |  0.48494166 |  0.76923077 | 0.08082030 |  10.00000000 |  8082.03 |
| M_freq_0: |   3.12967852 |   2.85858719 |  1.09483403 |  1.00000000 | 0.00899349 |   0.10000000 |     8.99 |
| M_freq_1: |   3.12967853 |   2.85858719 |  1.09483403 |  1.00000000 | 0.00899349 |   0.10000000 |     8.99 |
| M_freq_2: |   3.12967853 |   2.85858719 |  1.09483403 |  1.00000000 | 0.00899349 |   0.10000000 |     8.99 |
| M_freq_3: |   3.12967854 |   2.85858719 |  1.09483403 |  1.00000000 | 0.00899349 |   0.10000000 |     8.99 |
| M_freq_4: |   4.44114983 |   5.66706047 |  0.78367786 |  1.00000000 | 0.04679527 |   0.10000000 |    46.80 |
| M_freq_5: |   4.44114983 |   5.66706047 |  0.78367786 |  1.00000000 | 0.04679527 |   0.10000000 |    46.80 |
| H_freq_0: |   3.56294341 |   4.80643423 |  0.74128621 |  1.00000000 | 0.06693283 |   0.10000000 |    66.93 |
| H_freq_1: |   3.56294341 |   5.58010025 |  0.63850885 |  1.00000000 | 0.13067585 |   0.10000000 |   130.68 |
| H_freq_2: |   4.02231872 |   5.65316738 |  0.71151594 |  1.00000000 | 0.08322305 |   0.10000000 |    83.22 |
| H_freq_3: |   4.02231872 |   6.36651842 |  0.63179252 |  1.00000000 | 0.13557675 |   0.10000000 |   135.58 |
| H_freq_4: |   5.19968857 |   6.40050186 |  0.81238764 |  1.00000000 | 0.03519840 |   0.10000000 |    35.20 |
| H_freq_5: |   5.19968857 |   7.64082373 |  0.68051414 |  1.00000000 | 0.10207122 |   0.10000000 |   102.07 |
| bandw.G:  |   4.42049130 |   5.87085872 |  0.57919601 |  0.76923077 | 0.03611321 |  20.00000000 |  7222.64 |
| bandw.K:  |   4.91982042 |   4.97424321 |  0.76081468 |  0.76923077 | 0.00007083 |  20.00000000 |    14.17 |
| bandw.M:  |   6.49536026 |   7.78109872 |  0.64212409 |  0.76923077 | 0.01615611 |  20.00000000 |  3231.22 |
| bandw.L:  |   5.06540139 |   6.34433701 |  0.61416388 |  0.76923077 | 0.02404574 |  20.00000000 |  4809.15 |
| bandw.H:  |   3.73204298 |   9.70902614 |  0.29568386 |  0.76923077 | 0.22424668 |  20.00000000 | 44849.34 |
**** Correct Energy Ordering 
START: OBJECTIVE FUNCTION

PARAMETERS
  fdd=0.1200000000 qdds=0.4500000000 qddp=0.4020149640 qddd=0.5500000000 b0=19.3912041951 p0=0.8397622740 b1=-5.0000000000 p1=0.6125838430 ndt=1.9500000000 cr1=
-6.4078161123 cr2=4.0100149484 r1dd=5.8556291745 rcdd=9.0734368256 cr3=-1.0000000000 rmaxhm=9.1641711939 npar=11 
VARGS
    -vfdd=0.1200000000 -vqdds=0.4500000000 -vqddp=0.4020149640 -vqddd=0.5500000000 -vb0=19.3912041951 -vp0=0.8397622740 -vb1=-5.0000000000 -vp1=0.6125838430 -vn
dt=1.9500000000 -vcr1=-6.4078161123 -vcr2=4.0100149484 -vr1dd=5.8556291745 -vrcdd=9.0734368256 -vcr3=-1.0000000000 -vrmaxhm=9.1641711939 



Getting hcp c/a 
Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -0.749344
         Iterations: 32
         Function evaluations: 65
Got a, c : a=5.9867278191, c=9.6892555891 c/a=1.6184560050. Volume per atom=150.3730732767
Targets  : a=5.5767896900, c=8.8521008200 c/a=1.5873112152. Volume per atom=119.2107777334
TBE bandwidths
 4.472 5.101 6.665 4.472 5.101 4.050 5.287 3.479
DFT bandwidths
 5.871 4.974 7.781 5.871 4.974 9.709 6.344 2.732
Bandwidths at symmetry points

|   | TBE [eV] | DFT [eV] |
|---+----------+----------|
| G |    4.472 |    5.871 |
| K |    5.101 |    4.974 |
| M |    6.665 |    7.781 |
| H |    4.050 |    9.709 |
| L |    5.287 |    6.344 |


Getting hcp shear constants ...

   mpirun -np 4 tbe ti   -vfdd=0.1200000000 -vqdds=0.4500000000 -vqddp=0.4020149640 -vqddd=0.5500000000 -vb0=19.3912041951 -vp0=0.8397622740 -vb1=-5.0000000000 -vp1=0.6125838430 -vndt=1.9500000000 -vcr1=-6.4078161123 -vcr2=4.0100149484 -vr1dd=5.8556291745 -vrcdd=9.0734368256 -vcr3=-1.0000000000 -vrmaxhm=9.1641711939  -vahcp=5.9867278191 -vchcp=9.6892555891   --mxq -vul=1 -vspecpos=1 -vspecplat=1 -vforces=1 -vnk=30  -vrelax=5 -vgtol=1d-6 -vxtol=1e-4 -vhess=100 -vforces=1 -vtetra=0 
 C_11 =    103.577 GPa

 C_33 =    162.763 GPa

 C_44 =     28.860 GPa

 C_66 =      3.424 GPa

 C_12 =     97.095 GPa

 C_13 =     25.558 GPa

shear constants: c_11=103.6, c_33=162.8, c_44= 28.9, c_12= 97.1, c_13= 25.6, c_66=   3.4, S= 30.6, R=212.0, H= 60.3 
         target: c_11=176.1, c_33=190.5, c_44= 50.8, c_12= 86.9, c_13= 68.3, c_66=  44.6, S= 73.1, R=185.4, H=146.7 
   bulk modulus: 74; target: 110 

  Cauchy Pressures:                Predicted |   Expected   
                      C12 - C66 = 93.6713  |  42.3000
                      C13 - C44 = -3.3017  |  17.5000




Obtaining frequencies for M and H points in hcp Brillouin zone

M frequencies tbe (THz) =  2.3142518989  2.3142519077  2.3142519077  2.3142519164  5.2308543714  5.2308543714 
M frequencies LDA (THz)=  2.8585871860  2.8585871860  2.8585871860  2.8585871860  5.6670604683  5.6670604683 

H frequencies (THz) =  4.2305899190  4.2305899190  5.9089915133  5.9089915133  6.8954924587  6.8954924587 
H frequencies LDA (THz) =  4.8064342322  5.5801002486  5.6531673769  6.3665184154  6.4005018626  7.6408237318 

 DOS from soft modes in the phonons =  0.00000000 

Obtaining bcc Ti quantities

  trial bcc output from pfit = 0.0
  VF = 0.928689
  Epp bcc = 0.702084
Get hcp - fcc energy difference ..
Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -0.371123
         Iterations: 13
         Function evaluations: 28
 fcc minimum lattice parameter
  a_fcc = 8.442079,  a_fcc_exp = 7.886770 
E_fcc - E_hcp = 3.549mRy per atom 
 tbe       E_fcc - E_hcp =  3.549305 mRy per atom 
 PBE       E_fcc - E_hcp =  4.518800 mRy per atom 



Getting omega phase lattice constants and internal parameter ...

Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -1.126326
         Iterations: 28
         Function evaluations: 58

Got omega : a=9.3323, c=5.6333 c/a=0.6036, using u=1.0000. Volume per atom=141.6260
Targets   : a=8.7325, c=5.3234 c/a=0.6096, using u=1.0000. Volume per atom=117.1878
 tbe       E_omega - E_hcp = -0.769938 mRy per atom 
 PBE       E_omega - E_hcp = -0.633433 mRy per atom 


bcc:     a=  6.05, K=80 Volume per atom=111
target:  a=  6.18, K=118,                     
        E_bcc - E_hcp = 25.226mRy per atom 

Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -1.495622
         Iterations: 34
         Function evaluations: 71
Got a_4h, c_4h  : a=5.9858477414, c=19.3650333479 c/a=3.2351363056
Targets         : a=5.5632514583, c=17.7590803091 c/a=3.1922124035
tbe       E_4h - E_hcp =  0.766457 mRy per atom 
 PBE       E_4h - E_hcp =  3.171600 mRy per atom 


Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -2.237349
         Iterations: 33
         Function evaluations: 72
Got a_6h, c_6h  : a=5.9815405665, c=29.1147374608 c/a=4.8674312473
Targets         : a=5.5463938441, c=26.7713635263 c/a=4.8268053583
 tbe       E_6h - E_hcp =  1.780530 mRy per atom 
 PBE       E_6h - E_hcp =  3.720050 mRy per atom 



 Build Objective Function
     ... With Elastic Net Regularisation
parameter names       fdd     qdds     qddp     qddd       b0       p0       b1       p1      ndt      cr1      cr2 
parameter values    0.120    0.450    0.402    0.550   19.391    0.840   -5.000    0.613    1.950   -6.408    4.010 
          p_norm    0.760    2.851    2.547    3.484  122.852    5.320   31.677    3.881   12.354   40.596   25.405 

Total p_norm = 251.72825

 Quantity      predicted    target     norm_pred   norm_tar    sq diff.      weight    objective * 100^2 
------------------------------------------------------------------------------------------------------------------------
 a_hcp   :   5.98672782   5.57678969   5.98672782   5.57678969   0.16804927 500.00000000    840246.35
 c/a     :   1.61845600   1.58731122  12.16946783  11.93528444   0.05484186 100.00000000     54841.86
 a_omega :   9.33226327   8.73254342   1.16653291   1.09156793   0.00561975  10.00000000       561.97
 c_omega :   5.63325727   5.32343103   0.70415716   0.66542888   0.00149988  10.00000000       149.99
 a_4h    :   5.98584774   5.56325146   1.07596210   1.00000000   0.00577024   1.00000000        57.70
 c_4h    :  19.36503335  17.75908031   1.09042997   1.00000000   0.00817758   1.00000000        81.78
 a_6h    :   5.98154057   5.54639384   1.07845579   1.00000000   0.00615531   1.00000000        61.55
 c_6h    :  29.11473746  26.77136353   1.08753286   1.00000000   0.00766200   1.00000000        76.62
 a_bcc   :   6.04975325   6.17948863   0.86425046   0.88278409   0.00034350   1.00000000         3.43
 a_fcc   :   8.44207871   7.88677000   1.20601124   1.12668143   0.00629322   1.00000000        62.93
 DE(o,h) :  -0.76993833  -0.63343333  -0.05132922  -0.04222889   0.00008282 500.00000000       414.08
 DE(4h,h):   0.76645750   3.17160000   0.00306583   0.01268640   0.00009256 500.00000000       462.78
 DE(6h,h):   1.78053000   3.72005000   0.00712212   0.01488020   0.00006019 500.00000000       300.94
 DE(b,h) :  25.22576500   7.63520000   0.25480571   0.07712323   0.03157106   1.00000000       315.71
 DE(f,h) :   3.54930500   4.51880000   0.03585157   0.04564444   0.00009590 500.00000000       479.50
 c_11    : 103.57652223 176.10000000   0.45243752   0.76923077   0.10035796  10.00000000     10035.80
 c_33    : 162.76310637 190.50000000   0.65723039   0.76923077   0.01254408  10.00000000      1254.41
 c_44    :  28.85957408  50.80000000   0.43700142   0.76923077   0.11037634  10.00000000     11037.63
 c_12    :  97.09534670  86.90000000   0.85947904   0.76923077   0.00814475  10.00000000       814.47
 c_13    :  25.55784315  68.30000000   0.28784596   0.76923077   0.23173133  10.00000000     23173.13
 M_freq_0:   2.31425190   2.85858719   0.44976606   0.55555556   0.01119142   0.10000000        11.19
 M_freq_1:   2.31425191   2.85858719   0.44976606   0.55555556   0.01119142   0.10000000        11.19
 M_freq_2:   2.31425191   2.85858719   0.44976606   0.55555556   0.01119142   0.10000000        11.19
 M_freq_3:   2.31425192   2.85858719   0.44976606   0.55555556   0.01119142   0.10000000        11.19
 M_freq_4:   5.23085437   5.66706047   0.51279322   0.55555556   0.00182862   0.10000000         1.83
 M_freq_5:   5.23085437   5.66706047   0.51279322   0.55555556   0.00182862   0.10000000         1.83
 H_freq_0:   4.23058992   4.80643423   0.48899613   0.55555556   0.00443016   0.10000000         4.43
 H_freq_1:   4.23058992   5.58010025   0.42119812   0.55555556   0.01805192   0.10000000        18.05
 H_freq_2:   5.90899151   5.65316738   0.58069624   0.55555556   0.00063205   0.10000000         0.63
 H_freq_3:   5.90899151   6.36651842   0.51563081   0.55555556   0.00159399   0.10000000         1.59
 H_freq_4:   6.89549246   6.40050186   0.59852012   0.55555556   0.00184595   0.10000000         1.85
 H_freq_5:   6.89549246   7.64082373   0.50136337   0.55555556   0.00293679   0.10000000         2.94
 bandw. G:   4.47219295   5.87085872   0.42320072   0.55555556   0.01751780   5.00000000       875.89
 bandw. K:   5.10077620   4.97424321   0.56968758   0.55555556   0.00019971   5.00000000         9.99
 bandw. M:   6.66543148   7.78109872   0.47589905   0.55555556   0.00634516   5.00000000       317.26
 bandw. L:   5.28717427   6.34433701   0.46298282   0.55555556   0.00856971   5.00000000       428.49
 bandw. H:   4.05041631   9.70902614   0.23176694   0.55555556   0.10483907   5.00000000      5241.95
 DOS_err :   0.00000000   0.00000000   0.00000000   0.00000000   0.00000000   1.00000000         0.00

Objective function: 3468666
   with multiplicative penalty: 1.0
**** Also correct ordering and decent c/a
PARAMETERS fdd=0.0800000000 qdds=0.4612878308 qddp=0.3800000000
qddd=0.5104112183 b0=30.0000000000 p0=1.2341858340 b1=-2.6769978790
p1=0.8182791477 ndt=1.9000000000 cr1= -6.1417007164 cr2=3.7770656808
r1dd=5.8556291745 rcdd=9.0734368256 cr3=-1.0000000000 rmaxhm=9.1641711939
npar=11 r1dd=5.8556291745 rcdd=9.0734368256 cr3=-1.000 0000000
rmaxhm=9.1641711939 VARGS -vfdd=0.0800000000 -vqdds=0.4612878308
-vqddp=0.3800000000 -vqddd=0.5104112183 -vb0=30.0000000000 -vp0=1.2341858340
-vb1=-2.6769978790 -vp1=0.8182791477 -vn dt=1.9000000000 -vcr1=-6.1417007164
-vcr2=3.7770656808 -vr1dd=5.8556291745 -vrcdd=9.0734368256 -vcr3=-1.0000000000
-vrmaxhm=9.1641711939 -vr1dd=5.8556291745 -v rcdd=9.0734368256
-vcr3=-1.0000000000 -vrmaxhm=9.1641711939 


PARAMETERS 
fdd=0.1506961994 qdds=0.4284319583 qddp=0.3800000000
qddd=0.5375590712 b0=15.0000000000 p0=0.9000000000 
b1=-3.0252423571 p1=0.7000000000 
ndt=1.9000000000 
cr1= -5.0000000000 cr2=4.0049314720
r1dd=5.8556291745 rcdd=9.0734368256 
cr3=-1.0000000000 rmaxhm=9.1641711939
npar=11

 r1dd=5.8556291745 rcdd=9.0734368256 cr3=-1.000 0000000
rmaxhm=9.1641711939 VARGS -vfdd=0.1506961994 -vqdds=0.4284319583
-vqddp=0.3800000000 -vqddd=0.5375590712 -vb0=15.0000000000 -vp0=0.9000000000
-vb1=-3.0252423571 -vp1=0.7000000000 -vn dt=1.9000000000 -vcr1=-5.0000000000
-vcr2=4.0049314720 -vr1dd=5.8556291745 -vrcdd=9.0734368256 -vcr3=-1.0000000000
-vrmaxhm=9.1641711939 -vr1dd=5.8556291745 -v rcdd=9.0734368256
-vcr3=-1.0000000000 -vrmaxhm=9.1641711939 


PARAMETERS 
fdd=0.1227277254 qdds=0.3750000000 qddp=0.3750034988
qddd=0.5750000000 b0=5.0000000000 p0=0.8134968926 b1=0.0000000000
p1=0.4000000000 ndt=2.0047686616 cr1=-5 .0329846734 cr2=4.5000000000
r1dd=5.8556291745 rcdd=9.0734368256 cr3=-1.0000000000 rmaxhm=9.1641711939
npar=11 
VARGS 
-vfdd=0.1227277254 -vqdds=0.3750000000 -vqddp=0.3750034988
-vqddd=0.5750000000 -vb0=5.0000000000 -vp0=0.8134968926 -vb1=0.0000000000
-vp1=0.4000000000 -vndt=2.0047686616 -vcr1=-5.0329846734 -vcr2=4.5000000000
-vr1dd=5.8556291745 -vrcdd=9.0734368256 -vcr3=-1.0000000000
-vrmaxhm=9.1641711939 


*** Some decent Parameters. 

These are between lines 33722 -- 33872 in genetic_results_11_par_2019-05-24_onyx

START: OBJECTIVE FUNCTION PARAMETERS 
fdd=0.2333099092 qdds=0.553054336 qddp=0.5444939144
qddd=0.659614557 b0=112.9541786 p0=1.525026006 b1=-0.01877495619 p1=1.03686837
ndt=2.001695444 cr1=-6.026426049 cr2=4.014251378 r1=5.855629174500001 rc=9.07343682563
cr3=-1.0 rmaxh=9.1641711938863

VARGS -vfdd=0.2333099092 -vqdds=0.553054336 -vqddp=0.5444939144 -vqddd=0.659614557 -vb0=112.9541786
-vp0=1.525026006 -vb1=-0.01877495619 -vp1=1.03686837 -vndt=2.001695444 -vcr1=-6.026426049
-vcr2=4.014251378 -vr1=5.855629174500001 -vrc=9.07343682563 -vcr3=-1.0 -vrmaxhm=9.1641711938863



Getting hcp c/a Using Nelder-Mead Optimization terminated successfully. 
Current function value: -0.585568 
Iterations: 29 
Function evaluations: 61 
Got a, c : a=5.5255474990, c=8.6805083669 c/a=1.5709770604. Volume per atom=114.7615563109 
 Targets : a=5.5767896900, c=8.8521008200 c/a=1.5873112152. Volume per atom=119.2107777334 

TBE bandwidths 6.988 7.396 7.878 6.988 7.396 5.574 7.146 3.072 
DFT bandwidths 5.871 4.974 7.781 5.871 4.974 9.709 6.344 2.732 
Bandwidths at symmetry points

C_11 = 175.295 GPa 
C_33 = 195.484 GPa 
C_44 = 59.607 GPa 
C_66 = 52.556 GPa 
C_12 = 70.182 GPa 
C_13 = 67.458 GPa 

shear constants: c_11=175.3, c_33=195.5, c_44= 59.6, c_12= 70.2, c_13= 67.5, c_66= 52.6, S= 85.9, R=183.3, H=164.1 
target:          c_11=176.1, c_33=190.5, c_44= 50.8, c_12= 86.9, c_13= 68.3, c_66= 44.6, S= 73.1, R=185.4, H=146.7 
bulk modulus: 106; target: 110


Cauchy Pressures:        Predicted | Expected 
               C12 - C66 = 17.6256 | 42.3000 
               C13 - C44 =  7.8514 | 17.5000 

Obtaining frequencies for M and H points in hcp Brillouin zone 
M frequencies tbe (THz) = 3.3855778954 3.3855779082 3.3855779082 3.3855779210 4.9626576745
4.9626576745 
M frequencies LDA (THz)= 2.8585871860 2.8585871860 2.8585871860 2.8585871860 5.6670604683
5.6670604683 
H frequencies (THz) = 2.2411330234 2.2411330234 4.5007477683 4.5007477683 6.5053058575
6.5053058575 
H frequencies LDA (THz) = 4.8064342322 5.5801002486 5.6531673769 6.3665184154 6.4005018626
7.6408237318 
DOS from soft modes in the phonons = 0.00000000

fcc minimum lattice parameter
 a_fcc = 7.724259, a_fcc_exp = 7.886770 
E_fcc - E_hcp = 3.519mRy per atom tbe 
E_fcc - E_hcp = 3.518800 mRy per atom PBE 
E_fcc - E_hcp = 4.518800 mRy per atom

 Getting omega phase lattice constants and internal parameter ... Using
Nelder-Mead Optimization terminated successfully. Current function value: -0.868710
Iterations: 25 Function evaluations: 55 

Got omega : a=8.6286, c=5.4115 c/a=0.6272, using u=1.0000. Volume per atom=116.3081 
  Targets : a=8.7325, c=5.3234 c/a=0.6096, using u=1.0000. Volume per atom=117.1878 

tbe E_omega - E_hcp = 3.213987 mRy per atom 
PBE E_omega - E_hcp = -0.633433 mRy per atom 

bcc: a= 6.22, K=86 Volume per atom=120 target: a= 6.18, K=118, E_bcc - E_hcp = 16.777 mRy per atom

Got a_4h, c_4h : a=5.4769017240, c=17.6835588894 c/a=3.2287522728 Targets :
a=5.5632514583, c=17.7590803091 c/a=3.1922124035 tbe E_4h - E_hcp = 0.872843 mRy per atom
PBE E_4h - E_hcp = 3.171600 mRy per atom Using Nelder-Mead Optimization terminated
successfully. Current function value: -1.746218 Iterations: 32 Function evaluations: 69
Got a_6h, c_6h : a=5.4739794975, c=26.5764068305 c/a=4.8550431807 Targets :
a=5.5463938441, c=26.7713635263 c/a=4.8268053583 tbe E_6h - E_hcp = 1.747477 mRy per atom
PBE E_6h - E_hcp = 3.720050 mRy per atom
 
Quantity predicted target norm_pred norm_tar sq diff. weight objective * 100^2
------------------------------------------------------------------------------------------------------------------------
a_hcp :     5.52554750   5.57678969   5.52554750 5.57678969 0.00262576 500.00000000 13128.81
c/a :       1.57097706   1.58731122   11.81246493 11.93528444 0.01508463 100.00000000 15084.63
a_omega :   8.62860662   8.73254342   1.07857583 1.09156793 0.00016879 10.00000000 16.88
c_omega :   5.41151999   5.32343103   0.67644000 0.66542888 0.00012124 10.00000000 12.12
a_4h :      5.47690172   5.56325146   0.98447855 1.00000000 0.00024092 1.00000000 2.41 
c_4h :     17.68355889  17.75908031   0.99574745 1.00000000 0.00001808 1.00000000 0.18 
a_6h :      5.47397950   5.54639384   0.98694389 1.00000000 0.00017046 1.00000000 1.70 
c_6h :     26.57640683  26.77136353   0.99271772 1.00000000 0.00005303 1.00000000 0.53 
a_bcc :     6.21903633   6.17948863   0.88843376 0.88278409 0.00003192 1.00000000 0.32 
a_fcc :     7.72425941   7.88677000   1.10346563 1.12668143 0.00053897 1.00000000 5.39 
DE(o,h) :   3.21398667  -0.63343333   0.21426578 -0.04222889 0.06578951 1000.00000000 657895.14
DE(4h,h):   0.87284250   3.17160000   0.00349137 0.01268640 0.00008455 1000.00000000 845.49
DE(6h,h):   1.74747667   3.72005000   0.00698991 0.01488020 0.00006226 1000.00000000 622.57
DE(b,h) :  16.77652000   7.63520000   0.16945980 0.07712323 0.00852604 1.00000000 85.26
DE(f,h) :   3.51880000   4.51880000   0.03554343 0.04564444 0.00010203 1000.00000000 1020.30 
c_11 :    175.29473935 176.10000000   0.76571327 0.76923077 0.00001237 10.00000000 1.24 
c_33 :    195.48407861 190.50000000   0.78935626 0.76923077 0.00040504 10.00000000 40.50 
c_44 :     59.60662069  50.80000000   0.90258360 0.76923077 0.01778298 10.00000000 1778.30
c_12 :     70.18198888  86.90000000   0.62124448 0.76923077 0.02189994 10.00000000 2189.99 
c_13 :     67.45803041  68.30000000   0.75974806 0.76923077 0.00008992 10.00000000 8.99
M_freq_0:   3.38557790   2.85858719   0.65797420 0.55555556 0.01048958 0.10000000 10.49 
M_freq_1:   3.38557791   2.85858719   0.65797420 0.55555556 0.01048958 0.10000000 10.49 
M_freq_2:   3.38557791   2.85858719   0.65797420 0.55555556 0.01048958 0.10000000 10.49 
M_freq_3:   3.38557792   2.85858719   0.65797420 0.55555556 0.01048958 0.10000000 10.49 
M_freq_4:   4.96265767   5.66706047   0.48650126 0.55555556 0.00476850 0.10000000 4.77 
M_freq_5:   4.96265767   5.66706047   0.48650126 0.55555556 0.00476850 0.10000000 4.77
H_freq_0:   2.24113302   4.80643423   0.25904316 0.55555556 0.08791960 0.10000000 87.92
H_freq_1:   2.24113302   5.58010025   0.22312751 0.55555556 0.11050840 0.10000000 110.51
H_freq_2:   4.50074777   5.65316738   0.44230345 0.55555556 0.01282604 0.10000000 12.83
H_freq_3:   4.50074777   6.36651842   0.39274455 0.55555556 0.02650742 0.10000000 26.51
H_freq_4:   6.50530586   6.40050186   0.56465241 0.55555556 0.00008275 0.10000000 0.08
H_freq_5:   6.50530586   7.64082373   0.47299335 0.55555556 0.00681652 0.10000000 6.82
bandw. G:   6.98788653   5.87085872   0.66125917 0.55555556 0.01117325 20.00000000 2234.65
bandw. K:   7.39605747   4.97424321   0.82603939 0.55555556 0.07316150 20.00000000 14632.30
bandw. M:   7.87769918   7.78109872   0.56245264 0.55555556 0.00004757 20.00000000 9.51
bandw. L:   7.14571262   6.34433701   0.62572974 0.55555556 0.00492442 20.00000000 984.88
bandw. H:   5.57425450   9.70902614   0.31896176 0.55555556 0.05597662 20.00000000 11195.32
DOS_err :   0.00000000   0.00000000   0.00000000 0.00000000 0.00000000 1.00000000 0.00
Objective function: 130935647

*** Tony's Parameters from a while back 
fddtt=0.2682945357 cr2=4.025997513 cr3=-1.111420839 qddstt=0.5207844798 
qddptt=0.5973505422 qdddtt=0.5912147273 b0tt=112.8882442 p0tt=1.515638864 
ndt=1.932997842 r1tt=5.619063328 rctt=7.336192581
*** 2019-05-20
parameter names  fdd   qdds  qddp  qddd    b0    p0     b1    p1   ndt     cr1cr2 
parameter values 0.068 0.498 0.428 0.499 11.046 1.040 -0.924 0.459 2.001 -6.998 3.816

These values get omega to be far lower in energy than hcp and have the correct
structural ordering of energies. 


#+BEGIN_SRC bash
PARAMETERS fdd=0.1529368966 qdds=0.6276576462 qddp=0.5253318828 qddd=0.6487173415 
            b0=138.9153094023 p0=1.6253344339 b1=-26.9399528217 p1=1.7308613154 
           ndt=2.0122021577 cr1=-6.8211667573 cr2=4.4518001291 r1=1.0000000000 rc=1.3700000000 
           cr3=-1.0000000000 rmaxh=1.3837000000 npar=11


#+END_SRC
Bandwidth is a little small. Need to improve elastic constants a bit. 
c/a ratio is pretty good. 



#+BEGIN_SRC bash
START: OBJECTIVE FUNCTION

ti_obj_weights.py 
 starting..
   ext = ti ,
   file = fmin.val ,
   vals =  fdd=0.1174466123 qdds=0.3974516540 qddp=0.3909616843 qddd=0.4513787662 b0=12.4201609898 p0=1.1030807403 ndt=2.0279590685 cr1=-6.2099122560 cr2=3.942308298
6 r1=1.0308550249 rc=1.2000213349 cr3=-1.0000000000 rmaxh=1.2120215483 b1=0.0000000000 p1=0.0000000000 npar=11  
   binaries in /opt/lmto/bld7.13.0/openmpi/3.1.0/intel/14.0.1/o



Obtaining Bandwidth and optimising c and a 

    Bandwidth Scaling routine 

nbands = 18, ef = 0.02977, ncol = 2
Bandwidth at Gamma:
   TBE:    5.916 eV
   DFT:    5.900 eV


Getting hcp c/a 
Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -0.684831
         Iterations: 28
         Function evaluations: 64
Got a, c : a=5.4161008400, c=8.8279655592 c/a=1.6299485220. Volume per atom=112.1333377662
Targets  : a=5.5767896900, c=8.8521008200 c/a=1.5873112152. Volume per atom=119.2107777334

Getting hcp shear constants ...

 C_11 =    122.335 GPa

 C_33 =    124.303 GPa

 C_44 =     42.309 GPa

 C_66 =     44.277 GPa

 C_12 =     33.618 GPa

 C_13 =     33.782 GPa

shear constants: c_11=122.3, c_33=124.3, c_44= 42.3, c_12= 33.6, c_13= 33.8, c_66=  44.3, S= 64.4, R=134.7, H=133.5 
         target: c_11=176.1, c_33=190.5, c_44= 50.8, c_12= 86.9, c_13= 68.3, c_66=  44.6, S= 73.1, R=185.4, H=146.7 

   bulk modulus: 63; target: 110 

Obtaining frequencies for M and H points in hcp Brillouin zone

M frequencies tbe (THz) =  2.5331326195  2.5331326290  2.5331326290  2.5331326386  3.8256959262  3.8256959262 
M frequencies LDA (THz) =  2.8585871860  2.8585871860  2.8585871860  2.8585871860  5.6670604683  5.6670604683 

H frequencies tbe (THz) =  1.5399197708  1.5399197708  1.8398976627  1.8398976627  3.9669737038  3.9669737038 
H frequencies LDA (THz) =  4.8064342322  5.5801002486  5.6531673769  6.3665184154  6.4005018626  7.6408237318 

Obtaining bcc Ti quantities

  trial bcc output from pfit = 0.0
  VF = 0.825226
  Epp bcc = 3.71884
Get hcp - fcc energy difference ..
Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -0.336410
         Iterations: 14
         Function evaluations: 30
 fcc minimum lattice parameter
  a_fcc = 7.676507,  a_fcc_exp = 7.886770 
E_fcc - E_hcp = 6.006mRy per atom 

Getting omega phase lattice constants and internal parameter ...
Using Nelder-Mead

Optimization terminated successfully.
         Current function value: -1.029450
         Iterations: 27
         Function evaluations: 58

Got omega : a=8.4761, c=5.4016 c/a=0.6373, using u=1.0000. Volume per atom=112.0287
Targets   : a=8.7325, c=5.3234 c/a=0.6096, using u=1.0000. Volume per atom=117.1878
bcc:     a=  5.82, K=378 Volume per atom=98
target:  a=  6.18, K=118,                     
        E_bcc - E_hcp = 82.515mRy per atom 


 Build Objective Function
     ... With Elastic Net Regularisation
parameter names       fdd     qdds     qddp     qddd       b0       p0      ndt      cr1      cr2       r1       rc 
parameter values    0.117    0.397    0.391    0.451   12.420    1.103    2.028   -6.210    3.942    1.031    1.200 
          p_norm    0.509    1.722    1.694    1.955   53.802    4.778    8.785   26.900   17.078    4.466    0.000 

Total p_norm = 121.68857


 Quantity      predicted    target     norm_pred   norm_tar    sq diff.      weight    objective * 100^2 
------------------------------------------------------------------------------------------------------------------------
 a_hcp   :   5.41610084   5.57678969   5.41610084   5.57678969   0.02582091 1000.00000000    258209.07
 c_hcp   :   8.82796556   8.85210082   8.82796556   8.85210082   0.00058251 1000.00000000      5825.11
 c_11    : 122.33537796 176.10000000   1.86500000   2.85408495   0.97828904   1.00000000      9782.89
 c_33    : 124.30323926 190.50000000   1.89500000   3.08746839   1.42198086   1.00000000     14219.81
 c_44    :  42.30901811  50.80000000   0.64500000   0.82332490   0.03179977   1.00000000       318.00
 c_12    :  33.61763067  86.90000000   0.51250000   1.40840422   0.80264436   1.00000000      8026.44
 c_13    :  33.78161911  68.30000000   0.51500000   1.10695061   0.35040552   1.00000000      3504.06
 a_omega :   8.47612090   8.73254342   8.47612090   8.73254342   0.06575251  10.00000000      6575.25
 c_omega :   5.40164179   5.32343103   5.40164179   5.32343103   0.00611692  10.00000000       611.69
 DE(o,h) :  -0.73462833  -0.73475386  -0.73462833  -0.73475386   0.00000002  10.00000000         0.00
 DE(f,h) :   6.00578500   6.60015000   6.00578500   6.60015000   0.35326975  10.00000000     35326.98
 a_bcc   :   5.81618924   6.17948863   5.81618924   6.17948863   0.13198645   5.00000000      6599.32
 M_freq_0:   2.53313262   2.85858719   2.53313262   2.85858719   0.10592067   0.10000000       105.92
 M_freq_1:   2.53313263   2.85858719   2.53313263   2.85858719   0.10592067   0.10000000       105.92
 M_freq_2:   2.53313263   2.85858719   2.53313263   2.85858719   0.10592067   0.10000000       105.92
 M_freq_3:   2.53313264   2.85858719   2.53313264   2.85858719   0.10592066   0.10000000       105.92
 M_freq_4:   3.82569593   5.66706047   3.82569593   5.66706047   3.39062338   0.10000000      3390.62
 M_freq_5:   3.82569593   5.66706047   3.82569593   5.66706047   3.39062338   0.10000000      3390.62
 H_freq_0:   1.53991977   4.80643423   1.53991977   4.80643423  10.67011673   0.10000000     10670.12
 H_freq_1:   1.53991977   5.58010025   1.53991977   5.58010025  16.32305829   0.10000000     16323.06
 H_freq_2:   1.83989766   5.65316738   1.83989766   5.65316738  14.54102591   0.10000000     14541.03
 H_freq_3:   1.83989766   6.36651842   1.83989766   6.36651842  20.49029544   0.10000000     20490.30
 H_freq_4:   3.96697370   6.40050186   3.96697370   6.40050186   5.92205930   0.10000000      5922.06
 H_freq_5:   3.96697370   7.64082373   3.96697370   7.64082373  13.49717403   0.10000000     13497.17
 a_fcc   :   7.67650748   7.88677000   7.67650748   7.88677000   0.04421033   5.00000000      2210.52
 bw at G :   5.91588880   5.89956160   5.91588880   5.89956160   0.00026658 100.00000000       266.58

Objective function: 1657010

#+END_SRC
*** Notes on the fitting

<2019-05-22 Wed 13:56>
I am now not varying rc and r1 with the value of the lattice parameter. 
I am keeping it fixed at different ratios. 

|   r1 |    rc | Number of neighbour shells | Source        |
|------+-------+----------------------------+---------------|
| 1.02 | 1.370 |                          1 | This work     |
| 1.05 | 1.508 |                          2 | Matous BOP    |
| 1.05 | 1.627 |                          3 | Znam's Thesis |


<2019-05-15 Wed 09:15>

With the addition of the dhcp and 6H structures, one finds that previously
promising regions are not as good anymore. In general when constraining the
bond integral exponents to around 0.6 (1/ryd) one finds that the dhcp
structure may actually be lower in energy than that of the hcp structure. It
is hoped that this will be like the ANNI model in the fact that the number of
structures in the fitting will give correct stacking fault energies due to the
Ising-like interaction between the atomic planes of the atoms. 
** TODO Write first section of Literature review
*** TODO Summarise Stacking Faults and write review
*** TODO Write up the tight binding fitting of oxygen and an explanation for paramagnetism. 
*** TODO Summarise dislocations and Oxygen interactions (review)
** TODO See how the PDOS changes with addition of oxygen and how the tetrahedral/octahedral sites change this.
** TODO Calculate solution enthalpy of oxygen in titanium. 
- The solution enthalpy $E_{\text{sol}}$ and excess volume $\Delta V$ is 
  $$ E_{\text{sol} = E( \text{Ti}_n \text{O} ) - E( \text{Ti}_n ) - E(O) $$
  $$ \Delta V = V( \text{Ti}_n \text{O} ) - V( \text{Ti}_n ) $$
- $E( \text{Ti}_n \text{O} )$ is the excess energ of the bulk supercell with n
  Ti atoms and one impurity atom. $E( \text{Ti}_n )$ is the energy of the pure
  cells.
- Influence of cell sizes and solution enthalpy needs to be considered.

** TODO Has anyone investigated the stacking faults of Omega phase?
   - Maybe as Omega phase doesn't occur that often, perhaps it has not been
     studied in detail.
   - I should look further into thsi
** TODO Finish doing the gamma surfaces for all planes for pure titanium. 
*** Checking the convergence criteria
      - Now checking the convergence criteria.

**** How the lattice parameters change with the fineness of the k mesh
     - Maybe with a less fine k mesh the lattice parameters become
       worse. 
     - SOLUTION: The lattice parameters do not change that much under
     differences with the k mesh. [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/get_hom_shear_bc_gs.py::lattice_parameters_vs_k_mesh(%20tbe_command,%20minimiserf%3D'Nelder-Mead',%20plot%3DTrue,%20data%3Ddata)][File with change of the lattice
     parameters with k mesh. ]]
     [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/a_hcp_vs_nk.png][a vs nk]]
     [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/c_hcp_vs_nk.png][c_vs_nk]]
     [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/e_hcp_vs_nk.png][e_vs_nk]]

***** What if rmaxh is smaller or larger?
      - If rmaxh is is smaller (say rmaxh = 6.7 bohr) then we get the same
        results. 
   #+CAPTION: Variation of energy with k mesh.
   #+NAME:   fig:e_hcp_vs_nk_small_rmaxh.png
      file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/e_hcp_vs_nk_small_rmaxh_better_format.png
   #+CAPTION: Variation of a hcp with k mesh.
   #+NAME:   fig:a hcp_vs_nk_small_rmaxh.png
      file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/a_hcp_vs_nk_small_rmaxh_better_format.png
   #+CAPTION: Variation of c hcp with k mesh.
   #+NAME:   fig:c_hcp_vs_nk_small_rmaxh.png
      file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/c_hcp_vs_nk_small_rmaxh_better_format.png]]
	- Data: [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/a_hcp_vs_nk_rmaxh_small.pkl][a_hcp small rmaxh]], [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/c_hcp_vs_nk_rmaxh_small.pkl][c_hcp small rmaxh]], [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/e_hcp_vs_nk_rmaxh_small.pkl][e_hcp small rmaxh]]. 
      - If rmaxh is larger ( rmaxh = 20 bohr ), all possible interactions must
        be included then. And so we get the same results. 
   #+CAPTION: Variation of energy with k mesh.
   #+NAME:   fig:e_hcp_vs_nk_large_rmaxh.png
	[[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/e_hcp_vs_nk_large_rmaxh.png]]
   #+CAPTION: Variation of a hcp with k mesh.
   #+NAME:   fig:a_hcp_vs_nk_large_rmaxh.png
	[[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/a_hcp_vs_nk_large_rmaxh.png]]
   #+CAPTION: Variation of c hcp with k mesh.
   #+NAME:   fig:c_hcp_vs_nk_large_rmaxh.png
	[[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/c_hcp_vs_nk_large_rmaxh.png]]
      - Data: [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/a_hcp_vs_nk_rmaxh_large.pkl][a_hcp large rmaxh]], [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/c_hcp_vs_nk_rmaxh_large.pkl][c_hcp large rmaxh]], [[file:~/Documents/disl_gsurf/hcp_pris_screw/hcp_relaxed_pris_screw/gamma_surfaces/e_hcp_vs_nk_rmaxh_large.pkl][e_hcp large rmaxh]]
      
**** How does rmaxh change the lattice parameters?

***** How does rmaxh change the energy of a supercell
      - How does the number of neighbours change and what is the relation
	between rmaxh and larger cell sizes.
*** Notes on the model.
    It seems that there is a lot of charge moving around when doing the
    relaxations. 
    I think that this may be due to the fact that there is no Hubbard U
    interactions, a parameter for the coulomb interaction, which stops the
    charges from moving freely. 
    - TBE control file is currently set to this:
     #+BEGIN_SRC bash
TBE: nbas = 128 nspec = 1 verb 31 
TB: rmaxh = 20, m-stat: F-P rlx-vol, rho 
bz: metal
     #+END_SRC
    

     
*** DONE Implement Homogenous Shear boundary conditions for gamma surface calculation.
    CLOSED: [2018-11-19 Mon 12:08]
* Notes
** Dislocation dipole simulation

<2019-03-29 Fri>
It seems that actually, for the Clouet method, the /x/ component for the
accomodaton of strain is /positive/. These additions to the tilt vectors make
the dislocatons in a stable position in the quadrupolar array. 

There is no asymmetry in relaxations now between the dislocations of different
sign. This now works as expected. 




** Embedded atom method
This is a semi empirical method that does not take into account directional
bonding. It does not treat covalency or charge transfer. Neither does it
incorporate Fermi surface effects. 

 The main physical property incorporated in the EAM is the moderation of bond
 strength by other bonds (coordination-dependent bond strength).

* Completed Tasks                                                   :ARCHIVE:
** Investigate why rmaxh changes energy
   - Variation of rmaxh does not change the energy
   - Obviously the number of neighbours changes with rmaxh.
   - Conclusion: rmaxh only determines what atoms are its neighbours. 
   - This is the file which investigates this:
     [[file:~/Documents/ti/complete_titanium/ti_01-11-18/mod_rmaxh/check_rmaxh_energy_neighbours.py][check_rmaxh_energy_number_neighbours]]
   - Here is the data:
     [[file:~/Documents/ti/complete_titanium/ti_01-11-18/mod_rmaxh/energy_for_energy_vs_rmaxh.pkl][Energy data for energy vs rmaxh]]
     [[file:~/Documents/ti/complete_titanium/ti_01-11-18/mod_rmaxh/rmaxh_for_energy_or_n_neighbours_vs_rmaxh.pkl][rmaxh data for energy/n_neighbours vs rmaxh]]
     [[file:~/Documents/ti/complete_titanium/ti_01-11-18/mod_rmaxh/n_neighbours_for_n_neighbours_vs_rmaxh.pkl][n_neighbours for n_neighbours vs rmaxh]]
   - The output pictures are this:
   #+CAPTION: Variation of energy with change in rmaxh
   #+NAME:   fig:Energy_vs_rmaxh.png
   [[file:~/Documents/ti/complete_titanium/ti_01-11-18/mod_rmaxh/Energy_vs_rmaxh.png]]
   #+CAPTION: Variation of number of neighbours with change in rmaxh
   #+NAME:   fig:n_neighbours_vs_rmaxh.png
   [[file:~/Documents/ti/complete_titanium/ti_01-11-18/mod_rmaxh/n_neighbours_vs_rmaxh.png]]
   
** Show supercell of BOP working 

** Check Stability Criteria
   - Check if the matrix is complex
   - Check if it is positive definite. 
*** Results 
    - Without changing anything, the total energy of hcp in Tony's newest
      model is $E_{\text{tot hcp}} = -0.57230068 \text{Ryd}$
    - I thought perhaps that the lattice parameters and the elastic constants
      that way might produce a different result.
    - Minimising the lattice parameters gives an energy of  $E_{\text{tot
      hcp}} = -0.572351 \text{Ryd}$ with lattice parameters of
     $a_{\text{hcp}} = 5.4908 \text{bohr}$, $c_{\text{hcp}} = 8.8353 \text{bohr}$ giving $c/a_{\text{hcp}} = 1.6091 \text{bohr}$
    - Elastic constants, in GPa are \[ C_{11}=185.4, C_{33}=191.8, C_{44}= 39.7, C_{12}= 56.5, C_{13}= 56.1\]
    - The stability criteria are still satisfied. 
#+BEGIN_SRC bash
Checking Stability for tbe elastic constants. 
 is C_ij matrix positive definite?: True

Criteria for stability:

C_11 - C_12 > 0 
  True

C_11 + C_12 + C_33 > 0 
  True

( C_11 + C_12 ) * C_33 - 2 * C_13**2 > 0 
  True

C_44 > 0 
  True

(C_11 - C_12) > 0
  True

( C_11 + C_12 )*C_33 > 0 
  True

C_11 + C_12 > 0
  True

C_33 > 0
  True

C_11 > 0
  True

#+END_SRC
** Build force constant matrix for hcp 
   - If the force constant matrix is positive definite then there shan't be
     any soft modes.
*** Results
    - File used is [[file:~/Documents/ti/complete_titanium/ti_01-11-18/check_ec_pos_definite/check_ec_pos_definite.py][check_ec_pos_definite.py]]
    - Using Fourth order $\mathcal{O}(h^{4})$ formula for the mixed
      derivatives, one can find the $6\times6$ force constant matrix.
      \begin{align}
        \frac{1}{144 h^2} (     &  8.  (  f_{ 1,-2} +  f_{ 2,-1} + f_{-2, 1} + f_{-1, 2} )\\
                               &-  8.  (  f_{-1,-2} +  f_{-2,-1} + f_{ 1, 2} + f_{ 2, 1} )\\
                               &-  1.  (  f_{ 2,-2} +  f_{-2, 2} - f_{-2,-2} - f_{ 2, 2} )\\
                               &+  64. (  f_{-1,-1} +  f_{ 1, 1} - f_{ 1,-1} - f_{-1, 1} )  )
      \end{align}

      #+BEGIN_SRC bash
Eigenvalues
[-0.3173  0.3173  2.5963 -0.3185  0.3185 -2.5963]

 Is force constant matrix positive definite? False
Force Constant Matrix
[[ 7.7099e-13  2.3901e-11 -2.3901e-11 -3.1729e-01  2.3901e-11 -2.3901e-11]
 [-7.7099e-13  0.0000e+00  0.0000e+00 -7.7099e-13 -3.1847e-01  0.0000e+00]
 [ 7.7099e-13  0.0000e+00  0.0000e+00  7.7099e-13  0.0000e+00  2.5963e+00]
 [-3.1729e-01 -2.5443e-11  2.5443e-11  2.5443e-11 -2.5443e-11  2.5443e-11]
 [-7.7099e-13 -3.1847e-01  0.0000e+00 -7.7099e-13  0.0000e+00  0.0000e+00]
 [ 7.7099e-13  0.0000e+00  2.5963e+00  7.7099e-13  0.0000e+00  0.0000e+00]]
      #+END_SRC

    - This matrix is not positive definite and so the structure is not
      stable.

    - Using second order formula one obtains
      #+BEGIN_SRC bash
Eigenvalues
[ 0.32  -0.32   2.545 -2.545  0.32  -0.32 ]

 Is force constant matrix positive definite? False
Force Constant Matrix
[[ 0.     0.     0.    -0.32   0.     0.   ]
 [ 0.     0.     0.     0.    -0.32   0.   ]
 [ 0.     0.     0.     0.     0.     2.545]
 [-0.32   0.     0.     0.     0.     0.   ]
 [ 0.    -0.32   0.     0.     0.     0.   ]
 [ 0.     0.     2.545  0.     0.     0.   ]]

     #+END_SRC

    - Using another model we get another matrix that is not positive
      definite. 
      #+BEGIN_SRC bash
tbe ti -vhcp=1  -vfddtt=0.4668418806546737 -vqddstt=0.6660968695540497 -vb0tt=94.4011791926749 
-vp0tt=1.1902574670213237 -vb1tt=-26.704816810939302 -vp1tt=0.9999600888309667 
-vcr1=-6.158653986495596 -vcr2=3.9496749559495172 -vcr3=-1.0282840982939534 
-vndt=1.992406298332605 -vahcp=5.5274  -vqq=1.5997394796830335 -vrmaxh=8.51 -vnk=30 
Eigenvalues
[ 1.8512 -1.8512  0.2823 -0.2823 -0.281   0.281 ]

 Is force constant matrix positive definite? False
Force Constant Matrix
[[-2.4672e-13 -4.8572e-13 -5.0114e-13 -2.8232e-01  0.0000e+00  1.0618e-03]
 [-4.8572e-13  0.0000e+00  0.0000e+00  0.0000e+00 -2.8103e-01  0.0000e+00]
 [-5.0114e-13  0.0000e+00  0.0000e+00  1.0618e-03  0.0000e+00  1.8512e+00]
 [-2.8232e-01  0.0000e+00  1.0618e-03 -2.5443e-13  0.0000e+00 -1.0618e-03]
 [ 0.0000e+00 -2.8103e-01  2.4672e-13  0.0000e+00  0.0000e+00  0.0000e+00]
 [ 1.0618e-03 -2.4672e-13  1.8512e+00 -1.0618e-03 -2.4672e-13 -7.4015e-13]]
      #+END_SRC

** Make dislocations go through centre of triangle of atoms 

** Investigate why the gamma surface minima are not along the lines joining the vectors. 

** Change the lattice vectors to make the dislocation displacement fields periodic

** Why is the displacement in the x direction in the graphs of create cells?

** Make sure that the displacements are periodic 

** Calculate the Internal elastic constants, like in Cousins cite:Cousins1979

** Fix pyramidal gamma surface and how it erroneously writes to the site file only 12 atoms
** Python script: remove include statements  -->  One file.  





** DONE Could one see how to use Ising model SFEs and Fourier Interpolation?
CLOSED: [2019-03-13 Wed 19:37]
- Maybe one can do this for the Prismatic stacking fault.
  - The calculation only depends of periodicity perpendicular to the plane
    that one wants the stacking fault on.
  - This means that one can have a stacking that is probably ABCD or something
    Must investigate this further. 
** DONE Periodic dislocation arrays
CLOSED: [2019-03-13 Wed 20:21]
*** Clouet vs Cai S and O configuration
Using an array like this

[[file:Images/prismatic_quadrupole_wrong.png][Dipole to make quadrupolar array: before]]


Gives a variation of sx and sy, the vector that corrects for the spurious
linear term in the periodic solution like
[[file:Images/variation_of_sx_sy.png][Variation of sx and sy]] which should be approximately constant over the whole
of the cell. 

Makes cell like this 
[[file:Images/quadrupole_dislocations_periodic_wrong.png][Dipole to make quadrupolar array: after]]


With higher truncation limit for z we have:

[[file:Images/variationofsxsyhighertrunc.png][Variation of sx and sy with higher truncation (5,30)]]

Have come to the conclusion that Bulatov and Cai's work is reproducible, but
the statement by Emmanuel Clouet, that he took into effect the periodicity of
the lattice, seems dubious, at least from the standpoint of a periodic
displacement field. 

This is because, in Cai's work, one finds a linear correction 
$\mathbf{s}\cdot\mathbf{r}$ to the displacement modified by the periodic
images, $u_{\text{sum}}$.
When the dislocation dipole is in the same glide plane, as in Cai's work, 
the linear correction vector $\mathbf{s}$ (this is a tensor in general but it is just a
vector for one component of the displacement field), should be a constant. And
it is indeed a constant that varies only slightly depending on where one
measures it. 

Following the S or the O configuration like Clouet, one finds that there are
/distinct/ solutions for this $\mathbf{s}$ correction term depending the
position of measurement: there is one solution on the outer edges of the cut
planes and then another distinct solution inside. 

If one goes through and adds in the contribution from periodic dipoles one
does not find a periodic field, and even more troubling, is the fact that
atoms are displaced by a very large amount from the original position in the
unit cell ($\approx 100$ a.u.). 
*** Periodic dislocation dipoles Prismatic plane
*** Results
<2019-03-12 Tue 10:20>
**** Prismatic quadrupole cell size 12 x 12 x 1
***** Intro
Following the prescription set out by Tarrat, Clouet and Cai, one made a
supercell that is in the S configuration with a dislocation dipole that obeys
periodic displacements with an additional strain applied to the cell such that
the plastic strain that is introduced into the cell from the dislocation
dipole is cancelled. 
***** Results
With this cell size one found that there was weird behaviour with the
dislocations. 
This cell used 576 atoms. Upon relaxation, it seemed that the dislocations
were attracted to each other. One of the dislocations, only the one in the
lower left quadrant, dissociated into three partials:
- a $1/3[ 1 -1 0 0 ]$ dislocation which
  had it's core, according to ovito, displaced from the original position by
  roughly c/2 downwards and 2a to the right
- a $1/18[-4 0 4 3]$ dislocation which was situated approximately c/2 down and
  1/2a to the left
- and a $1/18[4 -6 2 -3]$ partial situated c upwards and 1/2a across.
***** Discussion
It seems that a larger cell size is necessary, even though in Clouet they used
cell sizes of 100 and 256 atoms in the S configuration. 

This implies that simply something is wrong with the implementation. 

The cell really is periodic in displacement so that should not be an issue. 

The model is certainly not perfect with the elastic constants being quite
wrong. 

The addition of strain to the lattice follows the paper by Clouet. 
Perhaps a calculation by hand is necessary for validation of this methods. 

The dislocation displacements are calculated using anisotropic elasticty
theory, perhaps the transformation that is being used to transform from the
Cartesian coordinate system of the elastic constants to that of the
dislocation reference frame is not perfect. 

***** TODO Check the transformation of the elastic constants is correct

***** TODO Validate the formula used to add strain to the lattice vectors 

***** TODO Find out what is the interaction energy of these dislocations and see if this has a bearing on the simulation

* Bibliography 
<<bibliography link>>

bibliographystyle:unsrt
bibliography:./bibliography/org-refs.bib

# \bibliographystyle{plain}
# \bibliography{org-refs.bib}

* Current Papers

** Omega phase transformation – morphologies and mechanisms. 
Banerjee, S., Tewari, R., & Dey, G. K. (2006). 
International Journal of Materials Research, 97(7),
963–977. doi:10.3139/146.101327 
cite:Banerjee_2006


Omega is found in both trigonal and perfect (hexagonal) forms. 
#
Positions are:
A: 0. 0. 0. 
B: 2/3 1/3 (1/2-z); 1/3 2/3 (1/2+z)

Where z = 1/6 is cubic symmetry. 

The two atomic sites in the omega unit cell are not equivalent.  B-type atomic
sites are more closely packed as compare to the A-type atomic site.

